// Parser module generated by unicc from logics.par.
// DO NOT EDIT THIS FILE MANUALLY, IT WILL GO AWAY!


class LogicsNode {
    constructor(emit, match, children) {
        this.emit = emit;
        this.match = match;
        this.children = children;
    }

    dump(level) {
        if( level === undefined )
            level = 0;

        if( this.emit !== undefined ) {
            let txt = this.emit;

            for( let i = 0; i < level; i++ )
                txt = " " + txt;

            if( this.match && this.match !== this.emit )
                txt += " (" + this.match + ")";

            console.log(txt);
            level++;
        }

        if( this.children ) {
            for( let child of this.children )
                if( Boolean( child ) )
                    child.dump(level);
        }
    }
}

class LogicsParserToken {
    constructor() {
        this.state = 0;
        this.line = 0;
        this.column = 0;

        this.node = null;

        value: null
    }
}

// Defining a custom exception for parse errors
class LogicsParseError extends Error {
    constructor(line, column, expecting) {
        super(`${line}:${column} Parse error, expecting '${expecting.join("', '")}'`);
        this.line = line;
        this.column = column;
        this.expecting = expecting;
    }
}

// Parser Control Block is used to handle parser states
class LogicsParserControlBlock {
    constructor() {
        // Stack
        this.stack = [];
        this.tos = null;

        // Values
        this.ret = null;

        // State
        this.act = null;
        this.idx = null;
        this.lhs = null;

        // Lookahead
        this.sym = -1;
        this.old_sym = -1;
        this.len = 0;

        // Lexical analysis
        this.lexem = null;
        this.next = null;
        this.eof = null;
        this.is_eof = false;

        // Input buffering
        this.input = null;
        this.buf = "";

        // Error handling
        this.error_delay = 3;
        this.error_count = 0;

        this.line = 1;
        this.column = 1;

        // User-defined
        
    }

    get top() {
        return this.stack[ this.stack.length - ( 0 + 1 ) ].value;
    }

    set top(value) {
        this.stack[ this.stack.length - ( 0 + 1 ) ].value = value;
    }

    // Parsing actions

    
    
}

// Parser

export default class LogicsParser {
    static #grammar = {
        "symbols": [
				{ "symbol": "&eof", "emit": "", "is-terminal": 3, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "for", "emit": "", "is-terminal": 2, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "False", "emit": "False", "is-terminal": 2, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "True", "emit": "True", "is-terminal": 2, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "**", "emit": "", "is-terminal": 2, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "in", "emit": "", "is-terminal": 2, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "!=", "emit": "!=", "is-terminal": 2, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "<>", "emit": "<>", "is-terminal": 2, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": ">", "emit": ">", "is-terminal": 2, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "<", "emit": "<", "is-terminal": 2, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "<=", "emit": "<=", "is-terminal": 2, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": ">=", "emit": ">=", "is-terminal": 2, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "==", "emit": "==", "is-terminal": 2, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "not", "emit": "", "is-terminal": 2, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "and", "emit": "", "is-terminal": 2, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "or", "emit": "", "is-terminal": 2, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "else", "emit": "", "is-terminal": 2, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "if", "emit": "", "is-terminal": 2, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "NUMBER", "emit": "NUMBER", "is-terminal": 2, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "STRING", "emit": "STRING", "is-terminal": 2, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 0 },
				{ "symbol": "IDENT", "emit": "IDENT", "is-terminal": 2, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "whitespace", "emit": "", "is-terminal": 2, "is-lexem": 0, "is-whitespace": 1, "is-greedy": 1 },
				{ "symbol": ",", "emit": "", "is-terminal": 1, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": ".", "emit": "", "is-terminal": 1, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": ":", "emit": "", "is-terminal": 1, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "]", "emit": "", "is-terminal": 1, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "[", "emit": "", "is-terminal": 1, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": ")", "emit": "", "is-terminal": 1, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "(", "emit": "", "is-terminal": 1, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "~", "emit": "", "is-terminal": 1, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "%", "emit": "", "is-terminal": 1, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "/", "emit": "", "is-terminal": 1, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "*", "emit": "", "is-terminal": 1, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "-", "emit": "", "is-terminal": 1, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "+", "emit": "", "is-terminal": 1, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "&embedded_5*", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "&embedded_5+", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "&embedded_5", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "&embedded_4?", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "&embedded_4", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "comprehension", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "STRING+", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "&embedded_3", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "list", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "opt_expression", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "trailer+", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "trailer", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "atom", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "entity", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "power", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "factor", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "term", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "&embedded_2+", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "&embedded_2", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "expr", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "comparison_op", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "comparison", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "&embedded_1+", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "&embedded_1", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "not_test", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "&embedded_0+", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "&embedded_0", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "and_test", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "or_test", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "if_else", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "test", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "expression", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 },
				{ "symbol": "logic", "emit": "", "is-terminal": 0, "is-lexem": 0, "is-whitespace": 0, "is-greedy": 1 }
        ],
        "productions": [
				{ "production": "logic : expression ~&eof", "emit": "", "length": 2, "left-hand-side": 67 },
				{ "production": "expression : test", "emit": "", "length": 1, "left-hand-side": 66 },
				{ "production": "test : if_else", "emit": "", "length": 1, "left-hand-side": 65 },
				{ "production": "test : or_test", "emit": "", "length": 1, "left-hand-side": 65 },
				{ "production": "if_else : or_test \"if\" or_test \"else\" test", "emit": "if_else", "length": 5, "left-hand-side": 64 },
				{ "production": "or_test : and_test &embedded_0+", "emit": "or_test", "length": 2, "left-hand-side": 63 },
				{ "production": "&embedded_0 : \"or\" and_test", "emit": "", "length": 2, "left-hand-side": 61 },
				{ "production": "&embedded_0+ : &embedded_0+ &embedded_0", "emit": "", "length": 2, "left-hand-side": 60 },
				{ "production": "&embedded_0+ : &embedded_0", "emit": "", "length": 1, "left-hand-side": 60 },
				{ "production": "or_test : and_test", "emit": "", "length": 1, "left-hand-side": 63 },
				{ "production": "and_test : not_test &embedded_1+", "emit": "and_test", "length": 2, "left-hand-side": 62 },
				{ "production": "&embedded_1 : \"and\" not_test", "emit": "", "length": 2, "left-hand-side": 58 },
				{ "production": "&embedded_1+ : &embedded_1+ &embedded_1", "emit": "", "length": 2, "left-hand-side": 57 },
				{ "production": "&embedded_1+ : &embedded_1", "emit": "", "length": 1, "left-hand-side": 57 },
				{ "production": "and_test : not_test", "emit": "", "length": 1, "left-hand-side": 62 },
				{ "production": "not_test : \"not\" not_test", "emit": "not_test", "length": 2, "left-hand-side": 59 },
				{ "production": "not_test : comparison", "emit": "", "length": 1, "left-hand-side": 59 },
				{ "production": "comparison_op : \"==\"", "emit": "", "length": 1, "left-hand-side": 55 },
				{ "production": "comparison_op : \">=\"", "emit": "", "length": 1, "left-hand-side": 55 },
				{ "production": "comparison_op : \"<=\"", "emit": "", "length": 1, "left-hand-side": 55 },
				{ "production": "comparison_op : \"<\"", "emit": "", "length": 1, "left-hand-side": 55 },
				{ "production": "comparison_op : \">\"", "emit": "", "length": 1, "left-hand-side": 55 },
				{ "production": "comparison_op : \"<>\"", "emit": "", "length": 1, "left-hand-side": 55 },
				{ "production": "comparison_op : \"!=\"", "emit": "", "length": 1, "left-hand-side": 55 },
				{ "production": "comparison_op : \"in\"", "emit": "in", "length": 1, "left-hand-side": 55 },
				{ "production": "comparison_op : \"not\" \"in\"", "emit": "not_in", "length": 2, "left-hand-side": 55 },
				{ "production": "comparison : expr &embedded_2+", "emit": "cmp", "length": 2, "left-hand-side": 56 },
				{ "production": "&embedded_2 : comparison_op expr", "emit": "", "length": 2, "left-hand-side": 53 },
				{ "production": "&embedded_2+ : &embedded_2+ &embedded_2", "emit": "", "length": 2, "left-hand-side": 52 },
				{ "production": "&embedded_2+ : &embedded_2", "emit": "", "length": 1, "left-hand-side": 52 },
				{ "production": "comparison : expr", "emit": "", "length": 1, "left-hand-side": 56 },
				{ "production": "expr : expr '+' term", "emit": "add", "length": 3, "left-hand-side": 54 },
				{ "production": "expr : expr '-' term", "emit": "sub", "length": 3, "left-hand-side": 54 },
				{ "production": "expr : term", "emit": "", "length": 1, "left-hand-side": 54 },
				{ "production": "term : term '*' factor", "emit": "mul", "length": 3, "left-hand-side": 51 },
				{ "production": "term : term '/' factor", "emit": "div", "length": 3, "left-hand-side": 51 },
				{ "production": "term : term '%' factor", "emit": "mod", "length": 3, "left-hand-side": 51 },
				{ "production": "term : factor", "emit": "", "length": 1, "left-hand-side": 51 },
				{ "production": "factor : '+' factor", "emit": "pos", "length": 2, "left-hand-side": 50 },
				{ "production": "factor : '-' factor", "emit": "neg", "length": 2, "left-hand-side": 50 },
				{ "production": "factor : '~' factor", "emit": "invert", "length": 2, "left-hand-side": 50 },
				{ "production": "factor : power", "emit": "", "length": 1, "left-hand-side": 50 },
				{ "production": "power : entity \"**\" factor", "emit": "pow", "length": 3, "left-hand-side": 49 },
				{ "production": "power : entity", "emit": "", "length": 1, "left-hand-side": 49 },
				{ "production": "entity : atom trailer+", "emit": "entity", "length": 2, "left-hand-side": 48 },
				{ "production": "trailer+ : trailer+ trailer", "emit": "", "length": 2, "left-hand-side": 45 },
				{ "production": "trailer+ : trailer", "emit": "", "length": 1, "left-hand-side": 45 },
				{ "production": "entity : atom", "emit": "", "length": 1, "left-hand-side": 48 },
				{ "production": "opt_expression : expression", "emit": "", "length": 1, "left-hand-side": 44 },
				{ "production": "opt_expression : ", "emit": "null", "length": 0, "left-hand-side": 44 },
				{ "production": "trailer : '(' list ')'", "emit": "", "length": 3, "left-hand-side": 46 },
				{ "production": "trailer : '[' expression ']'", "emit": "", "length": 3, "left-hand-side": 46 },
				{ "production": "trailer : '[' opt_expression ':' opt_expression ']'", "emit": "slice", "length": 5, "left-hand-side": 46 },
				{ "production": "trailer : '.' @IDENT", "emit": "", "length": 2, "left-hand-side": 46 },
				{ "production": "&embedded_3 : \"True\"", "emit": "", "length": 1, "left-hand-side": 42 },
				{ "production": "&embedded_3 : \"False\"", "emit": "", "length": 1, "left-hand-side": 42 },
				{ "production": "atom : &embedded_3", "emit": "", "length": 1, "left-hand-side": 47 },
				{ "production": "atom : @NUMBER", "emit": "", "length": 1, "left-hand-side": 47 },
				{ "production": "atom : @IDENT", "emit": "", "length": 1, "left-hand-side": 47 },
				{ "production": "atom : @STRING", "emit": "", "length": 1, "left-hand-side": 47 },
				{ "production": "STRING+ : STRING+ @STRING", "emit": "", "length": 2, "left-hand-side": 41 },
				{ "production": "STRING+ : @STRING", "emit": "", "length": 1, "left-hand-side": 41 },
				{ "production": "atom : STRING+", "emit": "concat", "length": 1, "left-hand-side": 47 },
				{ "production": "atom : comprehension", "emit": "", "length": 1, "left-hand-side": 47 },
				{ "production": "atom : '[' list ']'", "emit": "", "length": 3, "left-hand-side": 47 },
				{ "production": "atom : '(' expression ')'", "emit": "atom", "length": 3, "left-hand-side": 47 },
				{ "production": "comprehension : '[' expression \"for\" @IDENT \"in\" or_test &embedded_4? ']'", "emit": "comprehension", "length": 8, "left-hand-side": 40 },
				{ "production": "&embedded_4 : \"if\" expression", "emit": "", "length": 2, "left-hand-side": 39 },
				{ "production": "&embedded_4? : &embedded_4", "emit": "", "length": 1, "left-hand-side": 38 },
				{ "production": "&embedded_4? : ", "emit": "", "length": 0, "left-hand-side": 38 },
				{ "production": "list : expression &embedded_5*", "emit": "list", "length": 2, "left-hand-side": 43 },
				{ "production": "&embedded_5 : ',' expression", "emit": "", "length": 2, "left-hand-side": 37 },
				{ "production": "&embedded_5+ : &embedded_5+ &embedded_5", "emit": "", "length": 2, "left-hand-side": 36 },
				{ "production": "&embedded_5+ : &embedded_5", "emit": "", "length": 1, "left-hand-side": 36 },
				{ "production": "&embedded_5* : &embedded_5+", "emit": "", "length": 1, "left-hand-side": 35 },
				{ "production": "&embedded_5* : ", "emit": "", "length": 0, "left-hand-side": 35 },
				{ "production": "list : ", "emit": "list", "length": 0, "left-hand-side": 43 }
        ],
        "goal": 67
    };

    static #lexer = {
        "select": [
            
        ],
        "index": [
				[ 0, 41, 50, 51, 55, 56, 57, 59, 62, 63, 66, 67, 69, 70, 71, 72, 74, 75, 76, 77, 82, 87, 92, 93, 94, 95, 96, 97, 98, 99, 104, 109, 114, 119, 124, 129, 131, 138, 139, 141, 147, 153, 160, 166, 170, 175, 181, 188, 190, 197, 203, 210, 214, 220, 226, 233, 240, 247, 254, 261, 268, 275, 282, 289, 296 ]
        ],
        "chars": [
111, 111, 126, 126, 9, 10, 13, 13, 32, 32, 65, 69, 71, 83, 85, 90, 95, 95, 98, 100, 103, 104, 106, 109, 112, 122, 110, 110, 105, 105, 102, 102, 101, 101, 97, 97, 93, 93, 91, 91, 84, 84, 70, 70, 62, 62, 61, 61, 60, 60, 58, 58, 48, 57, 47, 47, 46, 46, 45, 45, 44, 44, 43, 43, 42, 42, 41, 41, 40, 40, 39, 39, 37, 37, 35, 35, 34, 34, 33, 33, -1, -1, 48, 57, 65, 90, 95, 95, 97, 101, 103, 109, 111, 122, 110, 110, 102, 102, -1, -1, -1, -1, 9, 10, 13, 13, 32, 32, -1, -1, -1, -1, -1, -1, 61, 61, -1, -1, 62, 62, 61, 61, -1, -1, -1, -1, 48, 57, 46, 46, -1, -1, -1, -1, 48, 57, -1, -1, -1, -1, -1, -1, -1, -1, 42, 42, -1, -1, -1, -1, -1, -1, -1, -1, 48, 57, 65, 90, 95, 95, 97, 122, -1, -1, 48, 57, 65, 90, 95, 95, 97, 122, -1, -1, 48, 57, 65, 90, 95, 95, 97, 122, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 48, 57, 65, 90, 95, 95, 97, 122, -1, -1, 48, 57, 65, 90, 95, 95, 97, 122, -1, -1, 48, 57, 65, 90, 95, 95, 97, 122, -1, -1, 48, 57, 65, 90, 95, 95, 97, 122, -1, -1, 48, 57, 65, 90, 95, 95, 97, 122, -1, -1, 48, 57, 65, 90, 95, 95, 97, 122, -1, -1, 61, 61, -1, -1, 48, 57, 65, 90, 95, 95, 97, 110, 112, 122, 111, 111, -1, -1, -1, -1, 48, 57, -1, -1, 92, 92, 39, 39, 0, 38, 40, 91, 93, 65535, -1, -1, 92, 92, 39, 39, 0, 38, 40, 91, 93, 65535, -1, -1, 48, 57, 65, 90, 95, 95, 97, 113, 115, 122, 114, 114, -1, -1, 92, 92, 34, 34, 0, 33, 35, 91, 93, 65535, -1, -1, 10, 10, 0, 9, 11, 65535, -1, -1, 48, 57, 65, 90, 95, 95, 97, 122, -1, -1, 92, 92, 34, 34, 0, 33, 35, 91, 93, 65535, -1, -1, 48, 57, 65, 90, 95, 95, 97, 107, 109, 122, 108, 108, -1, -1, 61, 61, -1, -1, 48, 57, 65, 90, 95, 95, 97, 109, 111, 122, 110, 110, -1, -1, 0, 38, 40, 91, 93, 65535, 92, 92, 39, 39, -1, -1, 48, 57, 65, 90, 95, 95, 97, 113, 115, 122, 114, 114, -1, -1, 0, 9, 11, 65535, 10, 10, -1, -1, 48, 57, 65, 90, 95, 95, 98, 122, 97, 97, -1, -1, 0, 33, 35, 91, 93, 65535, 92, 92, 34, 34, -1, -1, 48, 57, 65, 90, 95, 95, 97, 115, 117, 122, 116, 116, -1, -1, 48, 57, 65, 90, 95, 95, 97, 113, 115, 122, 114, 114, -1, -1, 48, 57, 65, 90, 95, 95, 97, 114, 116, 122, 115, 115, -1, -1, 48, 57, 65, 90, 95, 95, 97, 99, 101, 122, 100, 100, -1, -1, 48, 57, 65, 90, 95, 95, 97, 116, 118, 122, 117, 117, -1, -1, 48, 57, 65, 90, 95, 95, 97, 100, 102, 122, 101, 101, -1, -1, 48, 57, 65, 90, 95, 95, 97, 100, 102, 122, 101, 101, -1, -1, 48, 57, 65, 90, 95, 95, 97, 100, 102, 122, 101, 101, -1, -1, 48, 57, 65, 90, 95, 95, 97, 110, 112, 122, 111, 111, -1, -1, 48, 57, 65, 90, 95, 95, 97, 114, 116, 122, 115, 115, -1, -1, 48, 57, 65, 90, 95, 95, 97, 107, 109, 122, 108, 108, -1, -1
        ],
        "transitions": [
41, 2, 3, 3, 3, 44, 44, 44, 44, 44, 44, 44, 44, 36, 1, 62, 46, 48, 4, 5, 50, 52, 6, 35, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 40, 18, 43, 45, 47, -1, 44, 44, 44, 44, 44, 44, 19, 20, -1, -1, 3, 3, 3, -1, -1, -1, 22, -1, 24, 25, -1, -1, 9, 38, -1, -1, 38, -1, -1, -1, -1, 26, -1, -1, -1, -1, 44, 44, 44, 44, -1, 44, 44, 44, 44, -1, 44, 44, 44, 44, -1, -1, -1, -1, -1, -1, -1, -1, 44, 44, 44, 44, -1, 44, 44, 44, 44, -1, 44, 44, 44, 44, -1, 44, 44, 44, 44, -1, 44, 44, 44, 44, -1, 44, 44, 44, 44, -1, 23, -1, 44, 44, 44, 44, 44, 54, -1, -1, 38, -1, 49, 27, 40, 40, 40, -1, 49, 27, 40, 40, 40, -1, 44, 44, 44, 44, 44, 21, -1, 53, 27, 45, 45, 45, -1, 37, 51, 51, -1, 44, 44, 44, 44, -1, 53, 27, 45, 45, 45, -1, 44, 44, 44, 44, 44, 56, -1, 28, -1, 44, 44, 44, 44, 44, 57, -1, 40, 40, 40, 49, 39, -1, 44, 44, 44, 44, 44, 58, -1, 51, 51, 37, -1, 44, 44, 44, 44, 64, -1, 45, 45, 45, 53, 42, -1, 44, 44, 44, 44, 44, 29, -1, 44, 44, 44, 44, 44, 30, -1, 44, 44, 44, 44, 44, 59, -1, 44, 44, 44, 44, 44, 31, -1, 44, 44, 44, 44, 44, 60, -1, 44, 44, 44, 44, 44, 32, -1, 44, 44, 44, 44, 44, 33, -1, 44, 44, 44, 44, 44, 34, -1, 44, 44, 44, 44, 44, 55, -1, 44, 44, 44, 44, 44, 61, -1, 44, 44, 44, 44, 44, 63, -1
        ],
        "accept": [
				[ 0, 21, 30, 22, 26, 27, 9, 10, 25, 19, 32, 24, 34, 23, 35, 33, 28, 29, 31, 6, 18, 16, 12, 13, 8, 11, 5, 20, 7, 14, 2, 15, 17, 4, 3, 0, 21, 22, 19, 20, 0, 21, 20, 0, 21, 0, 21, 0, 21, 0, 21, 0, 21, 0, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21 ]
        ]
    };
    static #parser = {
        "action": [
				{ 20: [ 3,58 ], 19: [ 2,1 ], 18: [ 3,57 ], 13: [ 2,6 ], 34: [ 2,8 ], 33: [ 2,10 ], 29: [ 2,11 ], 28: [ 2,14 ], 26: [ 2,15 ], 3: [ 3,54 ], 2: [ 3,55 ] },
				{ 19: [ 1,61 ] },
				{ 0: [ 3,0 ] },
				{ 17: [ 2,17 ] },
				{ 15: [ 2,18 ] },
				{ 14: [ 2,20 ] },
				{ 20: [ 3,58 ], 19: [ 2,1 ], 18: [ 3,57 ], 13: [ 2,6 ], 34: [ 2,8 ], 33: [ 2,10 ], 29: [ 2,11 ], 28: [ 2,14 ], 26: [ 2,15 ], 3: [ 3,54 ], 2: [ 3,55 ] },
				{ 13: [ 2,22 ], 12: [ 3,17 ], 11: [ 3,18 ], 10: [ 3,19 ], 9: [ 3,20 ], 8: [ 3,21 ], 7: [ 3,22 ], 6: [ 3,23 ], 5: [ 3,24 ], 34: [ 2,25 ], 33: [ 2,26 ] },
				{ 20: [ 3,58 ], 19: [ 2,1 ], 18: [ 3,57 ], 34: [ 2,8 ], 33: [ 2,10 ], 29: [ 2,11 ], 28: [ 2,14 ], 26: [ 2,15 ], 3: [ 3,54 ], 2: [ 3,55 ] },
				{ 32: [ 2,27 ], 31: [ 2,28 ], 30: [ 2,29 ] },
				{ 20: [ 3,58 ], 19: [ 2,1 ], 18: [ 3,57 ], 34: [ 2,8 ], 33: [ 2,10 ], 29: [ 2,11 ], 28: [ 2,14 ], 26: [ 2,15 ], 3: [ 3,54 ], 2: [ 3,55 ] },
				{ 20: [ 3,58 ], 19: [ 2,1 ], 18: [ 3,57 ], 34: [ 2,8 ], 33: [ 2,10 ], 29: [ 2,11 ], 28: [ 2,14 ], 26: [ 2,15 ], 3: [ 3,54 ], 2: [ 3,55 ] },
				{ 4: [ 2,30 ] },
				{ 28: [ 2,32 ], 26: [ 2,33 ], 23: [ 2,34 ] },
				{ 20: [ 3,58 ], 19: [ 2,1 ], 18: [ 3,57 ], 13: [ 2,6 ], 34: [ 2,8 ], 33: [ 2,10 ], 29: [ 2,11 ], 28: [ 2,14 ], 26: [ 2,15 ], 3: [ 3,54 ], 2: [ 3,55 ] },
				{ 20: [ 3,58 ], 19: [ 2,1 ], 18: [ 3,57 ], 13: [ 2,6 ], 34: [ 2,8 ], 33: [ 2,10 ], 29: [ 2,11 ], 28: [ 2,14 ], 26: [ 2,15 ], 3: [ 3,54 ], 2: [ 3,55 ] },
				{ 19: [ 3,60 ] },
				{ 20: [ 3,58 ], 19: [ 2,1 ], 18: [ 3,57 ], 13: [ 2,6 ], 34: [ 2,8 ], 33: [ 2,10 ], 29: [ 2,11 ], 28: [ 2,14 ], 26: [ 2,15 ], 3: [ 3,54 ], 2: [ 3,55 ] },
				{ 20: [ 3,58 ], 19: [ 2,1 ], 18: [ 3,57 ], 13: [ 2,6 ], 34: [ 2,8 ], 33: [ 2,10 ], 29: [ 2,11 ], 28: [ 2,14 ], 26: [ 2,15 ], 3: [ 3,54 ], 2: [ 3,55 ] },
				{ 15: [ 2,18 ] },
				{ 20: [ 3,58 ], 19: [ 2,1 ], 18: [ 3,57 ], 13: [ 2,6 ], 34: [ 2,8 ], 33: [ 2,10 ], 29: [ 2,11 ], 28: [ 2,14 ], 26: [ 2,15 ], 3: [ 3,54 ], 2: [ 3,55 ] },
				{ 14: [ 2,20 ] },
				{ 5: [ 3,25 ] },
				{ 20: [ 3,58 ], 19: [ 2,1 ], 18: [ 3,57 ], 34: [ 2,8 ], 33: [ 2,10 ], 29: [ 2,11 ], 28: [ 2,14 ], 26: [ 2,15 ], 3: [ 3,54 ], 2: [ 3,55 ] },
				{ 13: [ 2,22 ], 12: [ 3,17 ], 11: [ 3,18 ], 10: [ 3,19 ], 9: [ 3,20 ], 8: [ 3,21 ], 7: [ 3,22 ], 6: [ 3,23 ], 5: [ 3,24 ] },
				{ 20: [ 3,58 ], 19: [ 2,1 ], 18: [ 3,57 ], 34: [ 2,8 ], 33: [ 2,10 ], 29: [ 2,11 ], 28: [ 2,14 ], 26: [ 2,15 ], 3: [ 3,54 ], 2: [ 3,55 ] },
				{ 20: [ 3,58 ], 19: [ 2,1 ], 18: [ 3,57 ], 34: [ 2,8 ], 33: [ 2,10 ], 29: [ 2,11 ], 28: [ 2,14 ], 26: [ 2,15 ], 3: [ 3,54 ], 2: [ 3,55 ] },
				{ 20: [ 3,58 ], 19: [ 2,1 ], 18: [ 3,57 ], 34: [ 2,8 ], 33: [ 2,10 ], 29: [ 2,11 ], 28: [ 2,14 ], 26: [ 2,15 ], 3: [ 3,54 ], 2: [ 3,55 ] },
				{ 20: [ 3,58 ], 19: [ 2,1 ], 18: [ 3,57 ], 34: [ 2,8 ], 33: [ 2,10 ], 29: [ 2,11 ], 28: [ 2,14 ], 26: [ 2,15 ], 3: [ 3,54 ], 2: [ 3,55 ] },
				{ 20: [ 3,58 ], 19: [ 2,1 ], 18: [ 3,57 ], 34: [ 2,8 ], 33: [ 2,10 ], 29: [ 2,11 ], 28: [ 2,14 ], 26: [ 2,15 ], 3: [ 3,54 ], 2: [ 3,55 ] },
				{ 20: [ 3,58 ], 19: [ 2,1 ], 18: [ 3,57 ], 34: [ 2,8 ], 33: [ 2,10 ], 29: [ 2,11 ], 28: [ 2,14 ], 26: [ 2,15 ], 3: [ 3,54 ], 2: [ 3,55 ] },
				{ 28: [ 2,32 ], 26: [ 2,33 ], 23: [ 2,34 ] },
				{ 20: [ 3,58 ], 19: [ 2,1 ], 18: [ 3,57 ], 13: [ 2,6 ], 34: [ 2,8 ], 33: [ 2,10 ], 29: [ 2,11 ], 28: [ 2,14 ], 26: [ 2,15 ], 3: [ 3,54 ], 2: [ 3,55 ] },
				{ 20: [ 3,58 ], 19: [ 2,1 ], 18: [ 3,57 ], 13: [ 2,6 ], 34: [ 2,8 ], 33: [ 2,10 ], 29: [ 2,11 ], 28: [ 2,14 ], 26: [ 2,15 ], 3: [ 3,54 ], 2: [ 3,55 ] },
				{ 20: [ 3,53 ] },
				{ 27: [ 3,65 ] },
				{ 1: [ 2,46 ], 22: [ 2,47 ] },
				{ 25: [ 3,64 ] },
				{ 16: [ 2,49 ] },
				{ 34: [ 2,25 ], 33: [ 2,26 ] },
				{ 32: [ 2,27 ], 31: [ 2,28 ], 30: [ 2,29 ] },
				{ 32: [ 2,27 ], 31: [ 2,28 ], 30: [ 2,29 ] },
				{ 22: [ 2,47 ] },
				{ 27: [ 3,50 ] },
				{ 25: [ 3,51 ] },
				{ 24: [ 2,50 ] },
				{ 20: [ 2,51 ] },
				{ 20: [ 3,58 ], 19: [ 2,1 ], 18: [ 3,57 ], 13: [ 2,6 ], 34: [ 2,8 ], 33: [ 2,10 ], 29: [ 2,11 ], 28: [ 2,14 ], 26: [ 2,15 ], 3: [ 3,54 ], 2: [ 3,55 ] },
				{ 22: [ 2,47 ] },
				{ 20: [ 3,58 ], 19: [ 2,1 ], 18: [ 3,57 ], 13: [ 2,6 ], 34: [ 2,8 ], 33: [ 2,10 ], 29: [ 2,11 ], 28: [ 2,14 ], 26: [ 2,15 ], 3: [ 3,54 ], 2: [ 3,55 ] },
				{ 20: [ 3,58 ], 19: [ 2,1 ], 18: [ 3,57 ], 13: [ 2,6 ], 34: [ 2,8 ], 33: [ 2,10 ], 29: [ 2,11 ], 28: [ 2,14 ], 26: [ 2,15 ], 3: [ 3,54 ], 2: [ 3,55 ] },
				{ 5: [ 2,53 ] },
				{ 25: [ 3,52 ] },
				{ 20: [ 3,58 ], 19: [ 2,1 ], 18: [ 3,57 ], 13: [ 2,6 ], 34: [ 2,8 ], 33: [ 2,10 ], 29: [ 2,11 ], 28: [ 2,14 ], 26: [ 2,15 ], 3: [ 3,54 ], 2: [ 3,55 ] },
				{ 17: [ 2,55 ] },
				{ 20: [ 3,58 ], 19: [ 2,1 ], 18: [ 3,57 ], 13: [ 2,6 ], 34: [ 2,8 ], 33: [ 2,10 ], 29: [ 2,11 ], 28: [ 2,14 ], 26: [ 2,15 ], 3: [ 3,54 ], 2: [ 3,55 ] },
				{ 25: [ 3,66 ] }
        ],
        "goto": [
				{ 66: [ 2,2 ], 65: [ 3,1 ], 64: [ 3,2 ], 63: [ 2,3 ], 62: [ 2,4 ], 59: [ 2,5 ], 56: [ 3,16 ], 54: [ 2,7 ], 51: [ 2,9 ], 50: [ 3,37 ], 49: [ 3,41 ], 48: [ 2,12 ], 47: [ 2,13 ], 42: [ 3,56 ], 41: [ 2,16 ], 40: [ 3,63 ] },
				{  },
				{  },
				{  },
				{ 61: [ 3,8 ], 60: [ 2,19 ] },
				{ 58: [ 3,13 ], 57: [ 2,21 ] },
				{ 59: [ 3,15 ], 56: [ 3,16 ], 54: [ 2,7 ], 51: [ 2,9 ], 50: [ 3,37 ], 49: [ 3,41 ], 48: [ 2,12 ], 47: [ 2,13 ], 42: [ 3,56 ], 41: [ 2,16 ], 40: [ 3,63 ] },
				{ 55: [ 2,23 ], 53: [ 3,29 ], 52: [ 2,24 ] },
				{ 50: [ 3,38 ], 49: [ 3,41 ], 48: [ 2,12 ], 47: [ 2,13 ], 42: [ 3,56 ], 41: [ 2,16 ], 40: [ 3,63 ] },
				{  },
				{ 50: [ 3,39 ], 49: [ 3,41 ], 48: [ 2,12 ], 47: [ 2,13 ], 42: [ 3,56 ], 41: [ 2,16 ], 40: [ 3,63 ] },
				{ 50: [ 3,40 ], 49: [ 3,41 ], 48: [ 2,12 ], 47: [ 2,13 ], 42: [ 3,56 ], 41: [ 2,16 ], 40: [ 3,63 ] },
				{  },
				{ 46: [ 3,46 ], 45: [ 2,31 ] },
				{ 66: [ 2,35 ], 65: [ 3,1 ], 64: [ 3,2 ], 63: [ 2,3 ], 62: [ 2,4 ], 59: [ 2,5 ], 56: [ 3,16 ], 54: [ 2,7 ], 51: [ 2,9 ], 50: [ 3,37 ], 49: [ 3,41 ], 48: [ 2,12 ], 47: [ 2,13 ], 42: [ 3,56 ], 41: [ 2,16 ], 40: [ 3,63 ] },
				{ 66: [ 2,36 ], 65: [ 3,1 ], 64: [ 3,2 ], 63: [ 2,3 ], 62: [ 2,4 ], 59: [ 2,5 ], 56: [ 3,16 ], 54: [ 2,7 ], 51: [ 2,9 ], 50: [ 3,37 ], 49: [ 3,41 ], 48: [ 2,12 ], 47: [ 2,13 ], 43: [ 2,37 ], 42: [ 3,56 ], 41: [ 2,16 ], 40: [ 3,63 ] },
				{  },
				{ 63: [ 2,38 ], 62: [ 2,4 ], 59: [ 2,5 ], 56: [ 3,16 ], 54: [ 2,7 ], 51: [ 2,9 ], 50: [ 3,37 ], 49: [ 3,41 ], 48: [ 2,12 ], 47: [ 2,13 ], 42: [ 3,56 ], 41: [ 2,16 ], 40: [ 3,63 ] },
				{ 62: [ 3,6 ], 59: [ 2,5 ], 56: [ 3,16 ], 54: [ 2,7 ], 51: [ 2,9 ], 50: [ 3,37 ], 49: [ 3,41 ], 48: [ 2,12 ], 47: [ 2,13 ], 42: [ 3,56 ], 41: [ 2,16 ], 40: [ 3,63 ] },
				{ 61: [ 3,7 ] },
				{ 59: [ 3,11 ], 56: [ 3,16 ], 54: [ 2,7 ], 51: [ 2,9 ], 50: [ 3,37 ], 49: [ 3,41 ], 48: [ 2,12 ], 47: [ 2,13 ], 42: [ 3,56 ], 41: [ 2,16 ], 40: [ 3,63 ] },
				{ 58: [ 3,12 ] },
				{  },
				{ 54: [ 2,39 ], 51: [ 2,9 ], 50: [ 3,37 ], 49: [ 3,41 ], 48: [ 2,12 ], 47: [ 2,13 ], 42: [ 3,56 ], 41: [ 2,16 ], 40: [ 3,63 ] },
				{ 55: [ 2,23 ], 53: [ 3,28 ] },
				{ 51: [ 2,40 ], 50: [ 3,37 ], 49: [ 3,41 ], 48: [ 2,12 ], 47: [ 2,13 ], 42: [ 3,56 ], 41: [ 2,16 ], 40: [ 3,63 ] },
				{ 51: [ 2,41 ], 50: [ 3,37 ], 49: [ 3,41 ], 48: [ 2,12 ], 47: [ 2,13 ], 42: [ 3,56 ], 41: [ 2,16 ], 40: [ 3,63 ] },
				{ 50: [ 3,34 ], 49: [ 3,41 ], 48: [ 2,12 ], 47: [ 2,13 ], 42: [ 3,56 ], 41: [ 2,16 ], 40: [ 3,63 ] },
				{ 50: [ 3,35 ], 49: [ 3,41 ], 48: [ 2,12 ], 47: [ 2,13 ], 42: [ 3,56 ], 41: [ 2,16 ], 40: [ 3,63 ] },
				{ 50: [ 3,36 ], 49: [ 3,41 ], 48: [ 2,12 ], 47: [ 2,13 ], 42: [ 3,56 ], 41: [ 2,16 ], 40: [ 3,63 ] },
				{ 50: [ 3,42 ], 49: [ 3,41 ], 48: [ 2,12 ], 47: [ 2,13 ], 42: [ 3,56 ], 41: [ 2,16 ], 40: [ 3,63 ] },
				{ 46: [ 3,45 ] },
				{ 66: [ 2,42 ], 65: [ 3,1 ], 64: [ 3,2 ], 63: [ 2,3 ], 62: [ 2,4 ], 59: [ 2,5 ], 56: [ 3,16 ], 54: [ 2,7 ], 51: [ 2,9 ], 50: [ 3,37 ], 49: [ 3,41 ], 48: [ 2,12 ], 47: [ 2,13 ], 43: [ 2,43 ], 42: [ 3,56 ], 41: [ 2,16 ], 40: [ 3,63 ] },
				{ 66: [ 2,44 ], 65: [ 3,1 ], 64: [ 3,2 ], 63: [ 2,3 ], 62: [ 2,4 ], 59: [ 2,5 ], 56: [ 3,16 ], 54: [ 2,7 ], 51: [ 2,9 ], 50: [ 3,37 ], 49: [ 3,41 ], 48: [ 2,12 ], 47: [ 2,13 ], 44: [ 2,45 ], 42: [ 3,56 ], 41: [ 2,16 ], 40: [ 3,63 ] },
				{  },
				{  },
				{ 37: [ 3,73 ], 36: [ 2,48 ], 35: [ 3,70 ] },
				{  },
				{  },
				{  },
				{  },
				{  },
				{ 37: [ 3,73 ], 36: [ 2,48 ], 35: [ 3,70 ] },
				{  },
				{  },
				{  },
				{  },
				{ 66: [ 3,71 ], 65: [ 3,1 ], 64: [ 3,2 ], 63: [ 2,3 ], 62: [ 2,4 ], 59: [ 2,5 ], 56: [ 3,16 ], 54: [ 2,7 ], 51: [ 2,9 ], 50: [ 3,37 ], 49: [ 3,41 ], 48: [ 2,12 ], 47: [ 2,13 ], 42: [ 3,56 ], 41: [ 2,16 ], 40: [ 3,63 ] },
				{ 37: [ 3,72 ] },
				{ 65: [ 3,4 ], 64: [ 3,2 ], 63: [ 2,3 ], 62: [ 2,4 ], 59: [ 2,5 ], 56: [ 3,16 ], 54: [ 2,7 ], 51: [ 2,9 ], 50: [ 3,37 ], 49: [ 3,41 ], 48: [ 2,12 ], 47: [ 2,13 ], 42: [ 3,56 ], 41: [ 2,16 ], 40: [ 3,63 ] },
				{ 66: [ 3,48 ], 65: [ 3,1 ], 64: [ 3,2 ], 63: [ 2,3 ], 62: [ 2,4 ], 59: [ 2,5 ], 56: [ 3,16 ], 54: [ 2,7 ], 51: [ 2,9 ], 50: [ 3,37 ], 49: [ 3,41 ], 48: [ 2,12 ], 47: [ 2,13 ], 44: [ 2,52 ], 42: [ 3,56 ], 41: [ 2,16 ], 40: [ 3,63 ] },
				{  },
				{  },
				{ 63: [ 2,54 ], 62: [ 2,4 ], 59: [ 2,5 ], 56: [ 3,16 ], 54: [ 2,7 ], 51: [ 2,9 ], 50: [ 3,37 ], 49: [ 3,41 ], 48: [ 2,12 ], 47: [ 2,13 ], 42: [ 3,56 ], 41: [ 2,16 ], 40: [ 3,63 ] },
				{ 39: [ 3,68 ], 38: [ 2,56 ] },
				{ 66: [ 3,67 ], 65: [ 3,1 ], 64: [ 3,2 ], 63: [ 2,3 ], 62: [ 2,4 ], 59: [ 2,5 ], 56: [ 3,16 ], 54: [ 2,7 ], 51: [ 2,9 ], 50: [ 3,37 ], 49: [ 3,41 ], 48: [ 2,12 ], 47: [ 2,13 ], 42: [ 3,56 ], 41: [ 2,16 ], 40: [ 3,63 ] },
				{  }
        ],
        "default-production": [
            -1, 59, -1, 3, 9, 14, -1, 30, -1, 33, -1, -1, 43, 47, -1, 76, 62, -1, -1, 5, -1, 10, -1, -1, 26, -1, -1, -1, -1, -1, -1, 44, 76, 49, -1, -1, 75, -1, -1, 27, 31, 32, 75, -1, 48, -1, -1, -1, 74, -1, 49, -1, -1, -1, 69, -1, -1
        ]
    };
    
    // Get character
    static #get_char(pcb) {
        // Get next character from input stream
        if( typeof pcb.input === "function" )
            return pcb.input();

        let ch = pcb.eof;

        if( pcb.input.length > 0 ) {
            ch = pcb.input[0];
            pcb.input = pcb.input.slice(1);
        }

        return ch;
    }

    static #get_input(pcb, offset) {
        // Input buffering
        while( offset >= pcb.buf.length ) {
            if( pcb.is_eof )
                return pcb.eof;

            let ch = this.#get_char(pcb);
            if( ch === pcb.eof ) {
                pcb.is_eof = true;
                return pcb.eof;
            }

            pcb.buf += ch;
        }

        //console.log("#get_input %s, %d, %s, %d", pcb.buf, offset, pcb.buf.charAt(offset), pcb.buf.charCodeAt(offset))

        return pcb.buf.charCodeAt(offset);
    }

    static #clear_input(pcb) {
        // Purge input from buffer that is not necessary anymore

        if( pcb.buf.length ) {
            // Perform position counting.
            for( let pos = 0; pos <= pcb.len; pos++ ) {
                if( pcb.buf[pos] === '\n' ) {
                    pcb.line++;
                    pcb.column = 0;
                }
                else
                    pcb.column++;
            }

            pcb.buf = pcb.buf.slice( pcb.len );
        }

        pcb.len = 0;
        pcb.sym = -1;
    }

    static #lex(pcb) {
        // Perform lexical analysis
        let state = 0, length = 0;

        let machine = Boolean(1) ? 0 : this.#lexer["select"][pcb.tos.state];
        let next = this.#get_input(pcb, length);

        if( next === pcb.eof ) {
            pcb.sym = 0;
            return;
        }

        while( state > -1 && next !== pcb.eof ) {
            let idx = this.#lexer["index"][machine][state];
            state = -1;

            while( this.#lexer["chars"][idx * 2] > -1 ) {
                if( next >= this.#lexer["chars"][idx * 2]
                        && next <= this.#lexer["chars"][idx * 2 + 1] ) {

                    length++;
                    state = this.#lexer["transitions"][idx];

                    if( this.#lexer["accept"][machine][state] > 0 ) {
                        pcb.sym = this.#lexer["accept"][machine][state] - 1;
                        pcb.len = length;

                        // Test! (??)
                        if( pcb.sym === 0 ) {
                            state = -1;
                            break;
                        }

                        // Stop if matched symbol should be parsed nongreedy
                        if( !Boolean(this.#grammar["symbols"][pcb.sym]["is-greedy"]) ) {
                            state = -1;
                            break;
                        }
                    }

                    next = this.#get_input(pcb, length);
                    break;
                }

                idx++;
            }

            // TODO: Semantic Terminal Selection?
        }

        //console.log("lex sym = %d, len = %d", pcb.sym, pcb.len);
    }

    static #get_sym(pcb) {
        // Get lookahead symbol
        pcb.sym = -1;
        pcb.len = 0;

        // insensitive mode
        if( Boolean(1) )
            while( true )
            {
                this.#lex(pcb);

                // check for whitespace
                if( pcb.sym > -1 && Boolean(this.#grammar["symbols"][pcb.sym]["is-whitespace"]) ) {
                    this.#clear_input(pcb);
                    continue;
                }

                break;
            }

        // sensitive mode
        else if( this.#lexer["select"][pcb.tos.state] > -1 )
            this.#lex(pcb);

        // If there is no matching DFA state machine, try to identify the
        // end-of-file symbol. If this also fails, a parse error will raise.
        else if( this.constructor.#get_input(pcb, 0) === pcb.eof )
            pcb.sym = 0;

        return Boolean(pcb.sym > -1);
    }

    parse(s) {
        // Constants
        const ERROR		= 0;
        const REDUCE	= 1;
        const SHIFT		= 2;
        const SUCCESS	= 4;

        // Start of parse function
        let pcb = new LogicsParserControlBlock()
        pcb.input = s
        pcb.act = SHIFT;

        pcb.tos = new LogicsParserToken()
        pcb.stack.push(pcb.tos)

        while( true ) {
            //console.log("state = %d", pcb.tos.state);

            // Reduce
            while( pcb.act & REDUCE ) {
                // Set default left-hand side
                pcb.lhs = this.constructor.#grammar["productions"][pcb.idx]["left-hand-side"];

                //console.log("REDUCE idx = %d, prod = %s", pcb.idx, this.constructor.#grammar["productions"][pcb.idx]["production"]);
                // print("state", pcb.tos.state);

                // Call reduce function
                //console.log("CALL", "_reduce_action_%d" % pcb.idx)

                if( ( "parse_" + pcb.idx ) in pcb )
                    pcb[ "parse_" + pcb.idx ]();

                // Drop right-hand side
                let cnodes = null, node = null;

                for( let i = 0; i < this.constructor.#grammar["productions"][pcb.idx]["length"]; i++ ) {
                    let item = pcb.stack.pop();

                    if( item.node )
                    {
                        if( cnodes === null )
                            cnodes = [];

                        if( Array.isArray( item.node ) )
                            cnodes = item.node.concat(cnodes);
                        else
                            cnodes.unshift(item.node);
                    }
                }

                pcb.tos = pcb.stack[pcb.stack.length - 1];
                pcb.tos.value = pcb.ret;

                // Handle AST nodes
                if( Boolean( this.constructor.#grammar["productions"][pcb.idx]["emit"] ) ) {
                    //console.log("%s = %s", this.constructor.#grammar["productions"][pcb.idx]["production"], this.#grammar["productions"][pcb.idx]["emit"]);
                    node = new LogicsNode(this.constructor.#grammar["productions"][pcb.idx]["emit"], null, cnodes);
                }

                // Goal symbol reduced, and stack is empty?
                if( pcb.lhs === 67 && pcb.stack.length === 1 ) {
                    pcb.tos.node = node ? node : cnodes;
                    this.constructor.#clear_input(pcb);
                    pcb.act = SUCCESS;
                    break;
                }

                // Get goto table entry
                pcb.act = this.constructor.#parser["goto"][pcb.tos.state][pcb.lhs][0];
                pcb.idx = this.constructor.#parser["goto"][pcb.tos.state][pcb.lhs][1];

                pcb.tos = new LogicsParserToken();
                pcb.stack.push(pcb.tos)

                pcb.tos.symbol = this.constructor.#grammar["symbols"][pcb.lhs];
                pcb.tos.state = pcb.act & REDUCE ? -1 : pcb.idx;
                pcb.tos.value = pcb.ret;

                pcb.tos.node = node ? node : cnodes;
                pcb.tos.value = pcb.ret;

                pcb.tos.line = pcb.line;
                pcb.tos.column = pcb.column;
            }

            if( pcb.act === SUCCESS || pcb.act === ERROR )
                break;

            // Get next input symbol
            this.constructor.#get_sym(pcb);

            //console.log("pcb.sym = %d (%s)", pcb.sym, this.constructor.#grammar["symbols"][pcb.sym]["symbol"]);
            //console.log("pcb.len = %d", pcb.len);

            // Get action table entry
            if( pcb.sym in this.constructor.#parser["action"][pcb.tos.state] ) {
                pcb.act = this.constructor.#parser["action"][pcb.tos.state][pcb.sym][0];
                pcb.idx = this.constructor.#parser["action"][pcb.tos.state][pcb.sym][1];
            } else {
                // Otherwise, apply default production
                pcb.idx = this.constructor.#parser["default-production"][pcb.tos.state];

                if( pcb.idx > -1 ) {
                    pcb.act = REDUCE;
                }
                else {
                    pcb.act = 0;
                }
            }

            if( !pcb.act ) {
                throw new LogicsParseError(
                    pcb.line,
                    pcb.column,
                    Object.keys(
                        this.constructor.#parser["action"][pcb.tos.state]
                    ).map(sym => this.constructor.#grammar.symbols[sym].symbol).sort()
                );
            }

            // Shift
            if( pcb.act & SHIFT ) {
                //console.log("SHIFT sym = %d (%s)", pcb.sym, this.constructor.#grammar["symbols"][pcb.sym]["symbol"]);

                pcb.tos = new LogicsParserToken();
                pcb.stack.push(pcb.tos);

                // Execute scanner actions, if existing.
                if( ( "scan_" + pcb.idx ) in pcb )
                    pcb[ "parse_" + pcb.idx ]();

                pcb.tos.state = pcb.act & REDUCE ? -1 : pcb.idx;
                pcb.tos.symbol = this.constructor.#grammar["symbols"][pcb.sym];

                pcb.tos.line = pcb.line;
                pcb.tos.column = pcb.column;
                pcb.top = pcb.buf.slice(0, pcb.len);

                if( Boolean( pcb.tos.symbol["emit"] ) )
                    pcb.tos.node = new LogicsNode(pcb.tos.symbol["emit"], pcb.top);

                if( pcb.sym !== 0 && pcb.sym !== -1 ) {
                    this.constructor.#clear_input(pcb);
                    pcb.old_sym = -1
                }
            }
        }

        if( !pcb.ret && pcb.tos.node ) {
            if( Array.isArray( pcb.tos.node ) ) {
                if( pcb.tos.node.length > 1 )
                    return new LogicsNode(null, null, pcb.tos.node);
                else
                    return pcb.tos.node.pop();
            }

            return pcb.tos.node;
        }

        return pcb.ret;
    }
}


